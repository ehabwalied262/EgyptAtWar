---
// src/components/Sidebar.astro
---

<!-- Import Tailwind CSS -->
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.3/dist/tailwind.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

<style>
  /* Custom Hover Effects */
  .menu-item {
    @apply hover:text-white cursor-pointer; /* Using Tailwind's apply for cleaner syntax */
  }

  /* Active Subtopic Styling */
  .submenu li.active {
    @apply text-black font-bold;
  }

  /* Submenu Item Styling */
  .submenu-item {
    @apply p-2 hover:cursor-pointer;
  }

  #content-display {
    @apply text-white p-4;
  }
</style>
  <!-- Sidebar -->
  <div id="sidebar" class="w-64 bg-darkBackground transition-width duration-300 ease-in-out overflow-y-auto scrollbar-hide border-r border-gray-500/50">
    <!-- Menu Items -->
    <ul class="menu px-4">

      <li>
        <div class="menu-item flex items-center gap-2 p-2 cursor-pointer" onclick="toggleSubMenu(event)">
          <i class="fa-solid fa-newspaper"></i>
          <span class="submenu-title">Articles</span>
        </div>
        <ul class="submenu hidden pl-4">
          <li class="menu-item p-2" onclick="selectSubtopic('New')">New</li>
          <li class="menu-item p-2" onclick="selectSubtopic('Finance')">Finance</li>
          <li class="menu-item p-2" onclick="selectSubtopic('Culture')">Culture</li>
        </ul>
      </li>
   
      <li>
        <div class="menu-item flex items-center gap-2 p-2 cursor-pointer" onclick="toggleSubMenu(event)">
          <i class="fab fa-youtube"></i>
          <span class="submenu-title">YouTube Channels</span>
        </div>
        <ul class="submenu hidden pl-4">
          <li class="menu-item p-2" onclick="selectSubtopic('Tech')">Tech</li>
          <li class="menu-item p-2" onclick="selectSubtopic('Education')">Education</li>
          <li class="menu-item p-2" onclick="selectSubtopic('Gaming')">Gaming</li>
        </ul>
      </li>
      <li>
        <div class="menu-item flex items-center gap-2 p-2 cursor-pointer" onclick="toggleSubMenu(event)">
          <i class="fa-brands fa-telegram"></i>
          <span class="submenu-title">Telegram Communities</span>
        </div>
        <ul class="submenu hidden pl-4">
          <li class="menu-item p-2" onclick="selectSubtopic('Programming')">Programming</li>
          <li class="menu-item p-2" onclick="selectSubtopic('Design')">Design</li>
          <li class="menu-item p-2" onclick="selectSubtopic('AI')">AI</li>
        </ul>
      </li>
      <li>
        <div class="menu-item flex items-center gap-2 p-2 cursor-pointer" onclick="toggleSubMenu(event)">
          <i class="fa-brands fa-discord"></i>
          <span class="submenu-title">Discord Servers</span>
        </div>
        <ul class="submenu hidden pl-4">
          <li class="menu-item p-2" onclick="selectSubtopic('Dev Hub')">Dev Hub</li>
          <li class="menu-item p-2" onclick="selectSubtopic('Gamers')">Gamers</li>
          <li class="menu-item p-2" onclick="selectSubtopic('Music')">Music</li>
        </ul>
      </li>
      <li>
        <div class="menu-item flex items-center gap-2 p-2 cursor-pointer" onclick="toggleSubMenu(event)">
          <i class="fas fa-book"></i>
          <span class="submenu-title">Books</span>
        </div>
        <ul class="submenu hidden pl-4">
          <li class="menu-item p-2" onclick="selectSubtopic('Fiction')">Palestine</li>
          <li class="menu-item p-2" onclick="selectSubtopic('Non-Fiction')">Non-Fiction</li>
          <li class="menu-item p-2" onclick="selectSubtopic('Science')">Science</li>
          <li class="menu-item p-2" onclick="selectSubtopic('History')">History</li>
        </ul>
      </li>
      <li>
        <div class="menu-item flex items-center gap-2 p-2 cursor-pointer" onclick="toggleSubMenu(event)">
          <i class="fa-solid fa-users-line"></i>
          <span class="submenu-title">Figures</span>
        </div>
        <ul class="submenu hidden pl-4">
          <li class="menu-item p-2" onclick="selectSubtopic('Einstein')">Einstein</li>
          <li class="menu-item p-2" onclick="selectSubtopic('Tesla')">Tesla</li>
          <li class="menu-item p-2" onclick="selectSubtopic('Curie')">Curie</li>
        </ul>
      </li>
    </ul>
  </div>
</div>

<script>

function updateContent(text: String) {
    const contentDisplay = document.getElementById("content-display");
    if (contentDisplay) {
        contentDisplay.textContent = `Selected: ${text}`;
    }
}



function selectSubtopic(event: any) {
    const clickedItem = event.target.closest(".submenu li");
    if (!clickedItem || !clickedItem.textContent) return;

    // Remove active class from all subtopics
    document.querySelectorAll(".submenu li").forEach(item => {
        item.classList.remove("active", "text-white", "bg-gray-700");
    });

    // Add active class to the clicked subtopic
    clickedItem.classList.add("active", "text-white", "bg-gray-700");

    // Update content display
    updateContent(clickedItem.textContent.trim());
}

document.addEventListener("DOMContentLoaded", () => {
    // Default active subtopic
    const defaultSubtopic = document.querySelector(".submenu li[data-topic='Tech']");
    if (defaultSubtopic && defaultSubtopic.textContent) {
        defaultSubtopic.classList.add("active", "text-white", "bg-gray-700");
        updateContent(defaultSubtopic.textContent.trim());
    }

    // Attach event listeners to all subtopics
    document.querySelectorAll(".submenu li").forEach(item => {
        item.addEventListener("click", (event) => selectSubtopic(event));
    });
});

// Toggle submenu
const toggleSubMenu = (event: Event) => {
  const target = event.target as HTMLElement;;
  const menuItem = target.closest('.menu-item');

  if (!menuItem) return;

  const submenu = menuItem.nextElementSibling;

  if (submenu && submenu.classList.contains('submenu')) {
    submenu.classList.toggle('hidden');
  }
};

// Add event listeners
document.querySelectorAll('.menu-item').forEach(item => {
  item.addEventListener('click', (event: Event) => toggleSubMenu(event));
});

</script>